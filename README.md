Based on early implementations of Zach's WebGL engine, modified to support own needs.